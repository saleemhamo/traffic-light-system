<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md690"></a>
Building curl with Visual C++</h1>
<p>This document describes how to compile, build and install curl and libcurl from sources using the Visual C++ build tool. To build with VC++, you will of course have to first install VC++. The minimum required version of VC is 6 (part of Visual Studio 6). However using a more recent version is strongly recommended.</p>
<p>VC++ is also part of the Windows Platform SDK. You do not have to install the full Visual Studio or Visual C++ if all you want is to build curl.</p>
<p>The latest Platform SDK can be downloaded freely from [Windows SDK and emulator archive](<a href="https://developer.microsoft.com/en-us/windows/downloads/sdk-archive">https://developer.microsoft.com/en-us/windows/downloads/sdk-archive</a>)</p>
<h2><a class="anchor" id="autotoc_md691"></a>
Prerequisites</h2>
<p>If you wish to support zlib, OpenSSL, c-ares, ssh2, you will have to download them separately and copy them to the <code>deps</code> directory as shown below:</p>
<p>somedirectory\ |_curl-src | |_winbuild | |_deps |_ lib |_ include |_ bin</p>
<p>It is also possible to create the <code>deps</code> directory in some other random places and tell the <code>Makefile</code> its location using the <code>WITH_DEVEL</code> option.</p>
<h2><a class="anchor" id="autotoc_md692"></a>
Building straight from git</h2>
<p>When you check out code git and build it, as opposed from a released source code archive, you need to first run the <code>buildconf.bat</code> batch file (present in the source code root directory) to set things up.</p>
<h2><a class="anchor" id="autotoc_md693"></a>
Open a command prompt</h2>
<p>Open a Visual Studio Command prompt:</p>
<p>Using the **'Developer Command Prompt for VS [version]'** menu entry: where [version} is the Visual Studio version. The developer prompt at default uses the x86 mode. It is required to call <code>Vcvarsall.bat</code> to setup the prompt for the machine type you want. This type of command prompt may not exist in all Visual Studio versions.</p>
<p>See also: <a href="https://docs.microsoft.com/en-us/dotnet/framework/tools/developer-command-prompt-for-vs">Developer Command Prompt for Visual Studio</a> and <a href="https://docs.microsoft.com/en-us/cpp/build/how-to-enable-a-64-bit-visual-cpp-toolset-on-the-command-line">How to: Enable a 64-Bit, x64 hosted MSVC toolset on the command line</a></p>
<p>Using the **'VS [version] [platform] [type] Command Prompt'** menu entry: where [version] is the Visual Studio version, [platform] is e.g. x64 and [type] Native of Cross platform build. This type of command prompt may not exist in all Visual Studio versions.</p>
<p>See also: <a href="https://docs.microsoft.com/en-us/cpp/build/building-on-the-command-line">Set the Path and Environment Variables for Command-Line Builds</a></p>
<h2><a class="anchor" id="autotoc_md694"></a>
Build in the console</h2>
<p>Once you are in the console, go to the winbuild directory in the Curl sources:</p>
<p>cd curl-src\winbuild</p>
<p>Then you can call <code>nmake /f Makefile.vc</code> with the desired options (see below). The builds will be in the top src directory, <code>builds\</code> directory, in a directory named using the options given to the nmake call.</p>
<p>nmake /f Makefile.vc mode=&lt;static or dll&gt; &lt;options&gt;</p>
<p>where <code>&lt;options&gt;</code> is one or many of:</p>
<ul>
<li><code>VC=&lt;num&gt;</code> - VC version. 6 or later.</li>
<li><code>WITH_DEVEL=&lt;path&gt;</code> - Paths for the development files (SSL, zlib, etc.) Defaults to sibling directory: <code>../deps</code></li>
<li><code>WITH_SSL=&lt;dll/static&gt;</code> - Enable OpenSSL support, DLL or static</li>
<li><code>WITH_NGHTTP2=&lt;dll/static&gt;</code> - Enable HTTP/2 support, DLL or static</li>
<li><code>WITH_MSH3=&lt;dll/static&gt;</code> - Enable (experimental) HTTP/3 support, DLL or static</li>
<li><code>WITH_MBEDTLS=&lt;dll/static&gt;</code> - Enable mbedTLS support, DLL or static</li>
<li><code>WITH_CARES=&lt;dll/static&gt;</code> - Enable c-ares support, DLL or static</li>
<li><code>WITH_ZLIB=&lt;dll/static&gt;</code> - Enable zlib support, DLL or static</li>
<li><code>WITH_SSH=&lt;dll/static&gt;</code> - Enable libSSH support, DLL or static</li>
<li><code>WITH_SSH2=&lt;dll/static&gt;</code> - Enable libSSH2 support, DLL or static</li>
<li><code>WITH_PREFIX=&lt;dir&gt;</code> - Where to install the build</li>
<li><code>ENABLE_SSPI=&lt;yes/no&gt;</code> - Enable SSPI support, defaults to yes</li>
<li><code>ENABLE_IPV6=&lt;yes/no&gt;</code> - Enable IPv6, defaults to yes</li>
<li><code>ENABLE_IDN=&lt;yes or no&gt;</code> - Enable use of Windows IDN APIs, defaults to yes Requires Windows Vista or later</li>
<li><code>ENABLE_SCHANNEL=&lt;yes/no&gt;</code> - Enable native Windows SSL support, defaults to yes if SSPI and no other SSL library</li>
<li><code>ENABLE_OPENSSL_AUTO_LOAD_CONFIG=&lt;yes/no&gt;</code><ul>
<li>Enable loading OpenSSL configuration automatically, defaults to yes</li>
</ul>
</li>
<li><code>ENABLE_UNICODE=&lt;yes/no&gt;</code> - Enable UNICODE support, defaults to no</li>
<li><code>GEN_PDB=&lt;yes/no&gt;</code> - Generate External Program Database (debug symbols for release build)</li>
<li><code>DEBUG=&lt;yes/no&gt;</code> - Debug builds</li>
<li><code>MACHINE=&lt;x86/x64/arm64&gt;</code> - Target architecture (default is x86)</li>
<li><code>CARES_PATH=&lt;path&gt;</code> - Custom path for c-ares</li>
<li><code>MBEDTLS_PATH=&lt;path&gt;</code> - Custom path for mbedTLS</li>
<li><code>NGHTTP2_PATH=&lt;path&gt;</code> - Custom path for nghttp2</li>
<li><code>MSH3_PATH=&lt;path&gt;</code> - Custom path for msh3</li>
<li><code>SSH2_PATH=&lt;path&gt;</code> - Custom path for libSSH2</li>
<li><code>SSL_PATH=&lt;path&gt;</code> - Custom path for OpenSSL</li>
<li><code>ZLIB_PATH=&lt;path&gt;</code> - Custom path for zlib</li>
</ul>
<h2><a class="anchor" id="autotoc_md695"></a>
Static linking of Microsoft's C runtime (CRT):</h2>
<p>If you are using mode=static nmake will create and link to the static build of libcurl but <em>not</em> the static CRT. If you must you can force nmake to link in the static CRT by passing <code>RTLIBCFG=static</code>. Typically you shouldn't use that option, and nmake will default to the DLL CRT. <code>RTLIBCFG</code> is rarely used and therefore rarely tested. When passing <code>RTLIBCFG</code> for a configuration that was already built but not with that option, or if the option was specified differently, you must destroy the build directory containing the configuration so that nmake can build it from scratch.</p>
<p>This option is not recommended unless you have enough development experience to know how to match the runtime library for linking (that is, the CRT). If <code>RTLIBCFG=static</code> then release builds use <code>/MT</code> and debug builds use <code>/MTd</code>.</p>
<h2><a class="anchor" id="autotoc_md696"></a>
Building your own application with libcurl (Visual Studio example)</h2>
<p>When you build curl and libcurl, nmake will show the relative path where the output directory is. The output directory is named from the options nmake used when building. You may also see temp directories of the same name but with suffixes -obj-curl and -obj-lib.</p>
<p>For example let's say you've built curl.exe and libcurl.dll from the Visual Studio 2010 x64 Win64 Command Prompt:</p>
<p>nmake /f Makefile.vc mode=dll VC=10</p>
<p>The output directory will have a name similar to <code>..\builds\libcurl-vc10-x64-release-dll-ipv6-sspi-schannel</code>.</p>
<p>The output directory contains subdirectories bin, lib and include. Those are the directories to set in your Visual Studio project. You can either copy the output directory to your project or leave it in place. Following the example, let's assume you leave it in place and your curl top source directory is <code>C:\curl-7.82.0</code>. You would set these options for configurations using the x64 platform:</p>
<div class="fragment"><div class="line">- Configuration Properties &gt; Debugging &gt; Environment</div>
<div class="line">   PATH=C:\curl-7.82.0\builds\libcurl-vc10-x64-release-dll-ipv6-sspi-schannel\bin;%PATH%</div>
<div class="line"> </div>
<div class="line">- C/C++ &gt; General &gt; Additional Include Directories</div>
<div class="line">   C:\curl-7.82.0\builds\libcurl-vc10-x64-release-dll-ipv6-sspi-schannel\include;</div>
<div class="line"> </div>
<div class="line">- Linker &gt; General &gt; Additional Library Directories</div>
<div class="line">   C:\curl-7.82.0\builds\libcurl-vc10-x64-release-dll-ipv6-sspi-schannel\lib;</div>
<div class="line"> </div>
<div class="line">- Linker &gt; Input &gt; Additional Dependencies</div>
<div class="line">   libcurl.lib;</div>
</div><!-- fragment --><p>For configurations using the x86 platform (aka Win32 platform) you would need to make a separate x86 build of libcurl.</p>
<p>If you build libcurl static (<code>mode=static</code>) or debug (<code>DEBUG=yes</code>) then the library name will vary and separate builds may be necessary for separate configurations of your project within the same platform. This is discussed in the next section.</p>
<h2><a class="anchor" id="autotoc_md697"></a>
Building your own application with a static libcurl</h2>
<p>When building an application that uses the static libcurl library on Windows, you must define <code>CURL_STATICLIB</code>. Otherwise the linker will look for dynamic import symbols.</p>
<p>The static library name has an <code>_a</code> suffix in the basename and the debug library name has a <code>_debug</code> suffix in the basename. For example, <code>libcurl_a_debug.lib</code> is a static debug build of libcurl.</p>
<p>You may need a separate build of libcurl for each VC configuration combination (for example: Debug|Win32, Debug|x64, Release|Win32, Release|x64).</p>
<p>You must specify any additional dependencies needed by your build of static libcurl (for example: <code>advapi32.lib;crypt32.lib;normaliz.lib;ws2_32.lib;wldap32.lib</code>).</p>
<h2><a class="anchor" id="autotoc_md698"></a>
Legacy Windows and SSL</h2>
<p>When you build curl using the build files in this directory the default SSL backend will be Schannel (Windows SSPI), the native SSL library that comes with the Windows OS. Schannel in Windows &lt;= XP is not able to connect to servers that no longer support the legacy handshakes and algorithms used by those versions. If you will be using curl in one of those earlier versions of Windows you should choose another SSL backend like OpenSSL. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
