<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: checksrc</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">checksrc</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md75"></a> This is the tool we use within the curl project to scan C source code and check that it adheres to our <a class="el" href="md_build_2__deps_2curl-src_2docs_2_c_o_d_e___s_t_y_l_e.html">Source Code Style guide</a>.</p>
<h1><a class="anchor" id="autotoc_md76"></a>
Usage</h1>
<pre class="fragment">checksrc.pl [options] [file1] [file2] ...
</pre> <h1><a class="anchor" id="autotoc_md77"></a>
Command line options</h1>
<p><code>-W[file]</code> skip that file and exclude it from being checked. Helpful when, for example, one of the files is generated.</p>
<p><code>-D[dir]</code> directory name to prepend to file names when accessing them.</p>
<p><code>-h</code> shows the help output, that also lists all recognized warnings</p>
<h1><a class="anchor" id="autotoc_md78"></a>
What does <code>checksrc</code> warn for?</h1>
<p><code>checksrc</code> does not check and verify the code against the entire style guide. The script is an effort to detect the most common mistakes and syntax mistakes that contributors make before they get accustomed to our code style. Heck, many of us regulars do the mistakes too and this script helps us keep the code in shape. </p><pre class="fragment">checksrc.pl -h
</pre><p> Lists how to use the script and it lists all existing warnings it has and problems it detects. At the time of this writing, the existing <code>checksrc</code> warnings are:</p>
<ul>
<li><code>ASSIGNWITHINCONDITION</code>: Assignment within a conditional expression. The code style mandates the assignment to be done outside of it.</li>
<li><code>ASTERISKNOSPACE</code>: A pointer was declared like <code>char* name</code> instead of the more appropriate <code>char *name</code> style. The asterisk should sit next to the name.</li>
<li><code>ASTERISKSPACE</code>: A pointer was declared like <code>char * name</code> instead of the more appropriate <code>char *name</code> style. The asterisk should sit right next to the name without a space in between.</li>
<li><code>BADCOMMAND</code>: There is a bad <code>checksrc</code> instruction in the code. See the <b>Ignore certain warnings</b> section below for details.</li>
<li><code>BANNEDFUNC</code>: A banned function was used. The functions sprintf, vsprintf, strcat, strncat, gets are <b>never</b> allowed in curl source code.</li>
<li><code>BRACEELSE</code>: '} else' on the same line. The else is supposed to be on the following line.</li>
<li><code>BRACEPOS</code>: wrong position for an open brace (<code>{</code>).</li>
<li><code>BRACEWHILE</code>: more than once space between end brace and while keyword</li>
<li><code>COMMANOSPACE</code>: a comma without following space</li>
<li><code>COPYRIGHT</code>: the file is missing a copyright statement</li>
<li><code>CPPCOMMENTS</code>: <code>//</code> comment detected, that is not C89 compliant</li>
<li><code>DOBRACE</code>: only use one space after do before open brace</li>
<li><code>EMPTYLINEBRACE</code>: found empty line before open brace</li>
<li><code>EQUALSNOSPACE</code>: no space after <code>=</code> sign</li>
<li><code>EQUALSNULL</code>: comparison with <code>== NULL</code> used in if/while. We use <code>!var</code>.</li>
<li><code>EXCLAMATIONSPACE</code>: space found after exclamations mark</li>
<li><code>FOPENMODE</code>: <code>fopen()</code> needs a macro for the mode string, use it</li>
<li><code>INDENTATION</code>: detected a wrong start column for code. Note that this warning only checks some specific places and will certainly miss many bad indentations.</li>
<li><code>LONGLINE</code>: A line is longer than 79 columns.</li>
<li><code>MULTISPACE</code>: Multiple spaces were found where only one should be used.</li>
<li><code>NOSPACEEQUALS</code>: An equals sign was found without preceding space. We prefer <code>a = 2</code> and <em>not</em> <code>a=2</code>.</li>
<li><code>NOTEQUALSZERO</code>: check found using <code>!= 0</code>. We use plain <code>if(var)</code>.</li>
<li><code>ONELINECONDITION</code>: do not put the conditional block on the same line as <code>if()</code></li>
<li><code>OPENCOMMENT</code>: File ended with a comment (<code>/*</code>) still "open".</li>
<li><code>PARENBRACE</code>: <code>){</code> was used without sufficient space in between.</li>
<li><code>RETURNNOSPACE</code>: <code>return</code> was used without space between the keyword and the following value.</li>
<li><code>SEMINOSPACE</code>: There was no space (or newline) following a semicolon.</li>
<li><code>SIZEOFNOPAREN</code>: Found use of sizeof without parentheses. We prefer <code>sizeof(int)</code> style.</li>
<li><code>SNPRINTF</code> - Found use of <code>snprintf()</code>. Since we use an internal replacement with a different return code etc, we prefer <code>msnprintf()</code>.</li>
<li><code>SPACEAFTERPAREN</code>: there was a space after open parenthesis, <code>( text</code>.</li>
<li><code>SPACEBEFORECLOSE</code>: there was a space before a close parenthesis, <code>text )</code>.</li>
<li><code>SPACEBEFORECOMMA</code>: there was a space before a comma, <code>one , two</code>.</li>
<li><code>SPACEBEFOREPAREN</code>: there was a space before an open parenthesis, <code>if (</code>, where one was not expected</li>
<li><code>SPACESEMICOLON</code>: there was a space before semicolon, <code>;</code>.</li>
<li><code>TABS</code>: TAB characters are not allowed</li>
<li><code>TRAILINGSPACE</code>: Trailing whitespace on the line</li>
<li><code>TYPEDEFSTRUCT</code>: we frown upon (most) typedefed structs</li>
<li><code>UNUSEDIGNORE</code>: a <code>checksrc</code> inlined warning ignore was asked for but not used, that is an ignore that should be removed or changed to get used.</li>
</ul>
<h2><a class="anchor" id="autotoc_md79"></a>
Extended warnings</h2>
<p>Some warnings are quite computationally expensive to perform, so they are turned off by default. To enable these warnings, place a <code>.checksrc</code> file in the directory where they should be activated with commands to enable the warnings you are interested in. The format of the file is to enable one warning per line like so: <code>enable &lt;EXTENDEDWARNING&gt;</code></p>
<p>Currently these are the extended warnings which can be enabled:</p>
<ul>
<li><code>COPYRIGHTYEAR</code>: the current changeset has not updated the copyright year in the source file</li>
<li><code>STRERROR</code>: use of banned function strerror()</li>
<li><code>STDERR</code>: use of banned variable <code>stderr</code></li>
</ul>
<h1><a class="anchor" id="autotoc_md80"></a>
Ignore certain warnings</h1>
<p>Due to the nature of the source code and the flaws of the <code>checksrc</code> tool, there is sometimes a need to ignore specific warnings. <code>checksrc</code> allows a few different ways to do this.</p>
<h2><a class="anchor" id="autotoc_md81"></a>
Inline ignore</h2>
<p>You can control what to ignore within a specific source file by providing instructions to <code>checksrc</code> in the source code itself. See examples below. The instruction can ask to ignore a specific warning a specific number of times or you ignore all of them until you mark the end of the ignored section.</p>
<p>Inline ignores are only done for that single specific source code file.</p>
<p>Example </p><pre class="fragment">/* !checksrc! disable LONGLINE all */
</pre><p> This will ignore the warning for overly long lines until it is re-enabled with: </p><pre class="fragment">/* !checksrc! enable LONGLINE */
</pre><p> If the enabling is not performed before the end of the file, it will be enabled automatically for the next file.</p>
<p>You can also opt to ignore just N violations so that if you have a single long line you just cannot shorten and is agreed to be fine anyway: </p><pre class="fragment">/* !checksrc! disable LONGLINE 1 */
</pre><p> ... and the warning for long lines will be enabled again automatically after it has ignored that single warning. The number <code>1</code> can of course be changed to any other integer number. It can be used to make sure only the exact intended instances are ignored and nothing extra.</p>
<h2><a class="anchor" id="autotoc_md82"></a>
Directory wide ignore patterns</h2>
<p>This is a method we have transitioned away from. Use inline ignores as far as possible.</p>
<p>Make a <code>checksrc.skip</code> file in the directory of the source code with the false positive, and include the full offending line into this file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
