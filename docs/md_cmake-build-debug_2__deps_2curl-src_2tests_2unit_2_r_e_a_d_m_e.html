<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: README</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md1429"></a>
Unit tests</h1>
<p>The goal is to add tests for <em>all</em> functions in libcurl. If functions are too big and complicated, we should split them into smaller and testable ones.</p>
<h2><a class="anchor" id="autotoc_md1430"></a>
Build Unit Tests</h2>
<p><code>./configure --enable-debug</code> is required for the unit tests to build. To enable unit tests, there will be a separate static libcurl built that will be used exclusively for linking unit test programs. Just build everything as normal, and then you can run the unit test cases as well.</p>
<h2><a class="anchor" id="autotoc_md1431"></a>
Run Unit Tests</h2>
<p>Unit tests are run as part of the regular test suite. If you have built everything to run unit tests, to can do 'make test' at the root level. Or you can <code>cd tests</code> and <code>make</code> and then invoke individual unit tests with <code>./runtests.pl NNNN</code> where <code>NNNN</code> is the specific test number.</p>
<h2><a class="anchor" id="autotoc_md1432"></a>
Debug Unit Tests</h2>
<p>If a specific test fails you will get told. The test case then has output left in the LOGDIR subdirectory, but most importantly you can re-run the test again using gdb by doing <code>./runtests.pl -g NNNN</code>. That is, add a <code>-g</code> to make it start up gdb and run the same case using that.</p>
<h2><a class="anchor" id="autotoc_md1433"></a>
Write Unit Tests</h2>
<p>We put tests that focus on an area or a specific function into a single C source file. The source file should be named <code>unitNNNN.c</code> where <code>NNNN</code> is a previously unused number.</p>
<p>Add your test to <code>tests/unit/Makefile.inc</code> (if it is a unit test). Add your test data file name to <code>tests/data/Makefile.inc</code></p>
<p>You also need a separate file called <code>tests/data/testNNNN</code> (using the same number) that describes your test case. See the test1300 file for inspiration and the <code>tests/FILEFORMAT.md</code> documentation.</p>
<p>For the actual C file, here's a simple example: ~~~c </p><pre class="fragment">#include "curlcheck.h"

#include "a libcurl header.h" /* from the lib dir */

static CURLcode unit_setup( void )
{
  /* whatever you want done first */
  return CURLE_OK;
}

static void unit_stop( void )
{
  /* done before shutting down and exiting */
}

UNITTEST_START

  /* here you start doing things and checking that the results are good */

  fail_unless( size == 0 , "initial size should be zero" );
  fail_if( head == NULL , "head should not be initiated to NULL" );

  /* you end the test code like this: */

UNITTEST_STOP
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
