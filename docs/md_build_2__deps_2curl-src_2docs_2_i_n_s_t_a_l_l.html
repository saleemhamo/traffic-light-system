<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: how to install curl and libcurl</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">how to install curl and libcurl</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md376"></a> </p>
<h1><a class="anchor" id="autotoc_md377"></a>
Installing Binary Packages</h1>
<p>Lots of people download binary distributions of curl and libcurl. This document does not describe how to install curl or libcurl using such a binary package. This document describes how to compile, build and install curl and libcurl from source code.</p>
<h1><a class="anchor" id="autotoc_md378"></a>
Building using vcpkg</h1>
<p>You can download and install curl and libcurl using the <a href="https://github.com/Microsoft/vcpkg/">vcpkg</a> dependency manager: </p><pre class="fragment">git clone https://github.com/Microsoft/vcpkg.git
cd vcpkg
./bootstrap-vcpkg.sh
./vcpkg integrate install
vcpkg install curl[tool]
</pre><p> The curl port in vcpkg is kept up to date by Microsoft team members and community contributors. If the version is out of date, please <a href="https://github.com/Microsoft/vcpkg">create an issue or pull request</a> on the vcpkg repository.</p>
<h1><a class="anchor" id="autotoc_md379"></a>
Building from git</h1>
<p>If you get your code off a git repository instead of a release tarball, see the <code>GIT-INFO</code> file in the root directory for specific instructions on how to proceed.</p>
<h1><a class="anchor" id="autotoc_md380"></a>
Unix</h1>
<p>A normal Unix installation is made in three or four steps (after you have unpacked the source archive): </p><pre class="fragment">./configure --with-openssl [--with-gnutls --with-wolfssl]
make
make test (optional)
make install
</pre><p> (Adjust the configure line accordingly to use the TLS library you want.)</p>
<p>You probably need to be root when doing the last command.</p>
<p>Get a full listing of all available configure options by invoking it like: </p><pre class="fragment">./configure --help
</pre><p> If you want to install curl in a different file hierarchy than <code>/usr/local</code>, specify that when running configure: </p><pre class="fragment">./configure --prefix=/path/to/curl/tree
</pre><p> If you have write permission in that directory, you can do 'make install' without being root. An example of this would be to make a local install in your own home directory: </p><pre class="fragment">./configure --prefix=$HOME
make
make install
</pre><p> The configure script always tries to find a working SSL library unless explicitly told not to. If you have OpenSSL installed in the default search path for your compiler/linker, you do not need to do anything special. If you have OpenSSL installed in <code>/usr/local/ssl</code>, you can run configure like: </p><pre class="fragment">./configure --with-openssl
</pre><p> If you have OpenSSL installed somewhere else (for example, <code>/opt/OpenSSL</code>) and you have pkg-config installed, set the pkg-config path first, like this: </p><pre class="fragment">env PKG_CONFIG_PATH=/opt/OpenSSL/lib/pkgconfig ./configure --with-openssl
</pre><p> Without pkg-config installed, use this: </p><pre class="fragment">./configure --with-openssl=/opt/OpenSSL
</pre><p> If you insist on forcing a build without SSL support, you can run configure like this: </p><pre class="fragment">./configure --without-ssl
</pre><p> If you have OpenSSL installed, but with the libraries in one place and the header files somewhere else, you have to set the <code>LDFLAGS</code> and <code>CPPFLAGS</code> environment variables prior to running configure. Something like this should work: </p><pre class="fragment">CPPFLAGS="-I/path/to/ssl/include" LDFLAGS="-L/path/to/ssl/lib" ./configure
</pre><p> If you have shared SSL libs installed in a directory where your runtime linker does not find them (which usually causes configure failures), you can provide this option to gcc to set a hard-coded path to the runtime linker: </p><pre class="fragment">LDFLAGS=-Wl,-R/usr/local/ssl/lib ./configure --with-openssl
</pre> <h2><a class="anchor" id="autotoc_md381"></a>
Static builds</h2>
<p>To force a static library compile, disable the shared library creation by running configure like: </p><pre class="fragment">./configure --disable-shared
</pre><p> The configure script is primarily done to work with shared/dynamic third party dependencies. When linking with shared libraries, the dependency "chain" is handled automatically by the library loader - on all modern systems.</p>
<p>If you instead link with a static library, you need to provide all the dependency libraries already at the link command line.</p>
<p>Figuring out all the dependency libraries for a given library is hard, as it might involve figuring out the dependencies of the dependencies and they vary between platforms and change between versions.</p>
<p>When using static dependencies, the build scripts will mostly assume that you, the user, will provide all the necessary additional dependency libraries as additional arguments in the build. With configure, by setting <code>LIBS</code> or <code>LDFLAGS</code> on the command line.</p>
<p>Building statically is not for the faint of heart.</p>
<h2><a class="anchor" id="autotoc_md382"></a>
Debug</h2>
<p>If you are a curl developer and use gcc, you might want to enable more debug options with the <code>--enable-debug</code> option.</p>
<p>curl can be built to use a whole range of libraries to provide various useful services, and configure will try to auto-detect a decent default. But if you want to alter it, you can select how to deal with each individual library.</p>
<h2><a class="anchor" id="autotoc_md383"></a>
Select TLS backend</h2>
<p>These options are provided to select the TLS backend to use.</p>
<ul>
<li>AmiSSL: <code>--with-amissl</code></li>
<li>BearSSL: <code>--with-bearssl</code></li>
<li>GnuTLS: <code>--with-gnutls</code>.</li>
<li>mbedTLS: <code>--with-mbedtls</code></li>
<li>OpenSSL: <code>--with-openssl</code> (also for BoringSSL, AWS-LC, libressl, and quictls)</li>
<li>rustls: <code>--with-rustls</code></li>
<li>Schannel: <code>--with-schannel</code></li>
<li>Secure Transport: <code>--with-secure-transport</code></li>
<li>wolfSSL: <code>--with-wolfssl</code></li>
</ul>
<p>You can build curl with <em>multiple</em> TLS backends at your choice, but some TLS backends cannot be combined: if you build with an OpenSSL fork (or wolfSSL), you cannot add another OpenSSL fork (or wolfSSL) simply because they have conflicting identical symbol names.</p>
<p>When you build with multiple TLS backends, you can select the active one at run-time when curl starts up.</p>
<h2><a class="anchor" id="autotoc_md384"></a>
configure finding libs in wrong directory</h2>
<p>When the configure script checks for third-party libraries, it adds those directories to the <code>LDFLAGS</code> variable and then tries linking to see if it works. When successful, the found directory is kept in the <code>LDFLAGS</code> variable when the script continues to execute and do more tests and possibly check for more libraries.</p>
<p>This can make subsequent checks for libraries wrongly detect another installation in a directory that was previously added to <code>LDFLAGS</code> by another library check.</p>
<h1><a class="anchor" id="autotoc_md385"></a>
Windows</h1>
<h2><a class="anchor" id="autotoc_md386"></a>
Building Windows DLLs and C runtime (CRT) linkage issues</h2>
<p>As a general rule, building a DLL with static CRT linkage is highly discouraged, and intermixing CRTs in the same app is something to avoid at any cost.</p>
<p>Reading and comprehending Microsoft Knowledge Base articles KB94248 and KB140584 is a must for any Windows developer. Especially important is full understanding if you are not going to follow the advice given above.</p>
<ul>
<li><a href="https://support.microsoft.com/help/94248/how-to-use-the-c-run-time">How To Use the C Run-Time</a></li>
<li><a href="https://docs.microsoft.com/cpp/build/reference/md-mt-ld-use-run-time-library">Run-Time Library Compiler Options</a></li>
<li><a href="https://docs.microsoft.com/cpp/c-runtime-library/potential-errors-passing-crt-objects-across-dll-boundaries">Potential Errors Passing CRT Objects Across DLL Boundaries</a></li>
</ul>
<p>If your app is misbehaving in some strange way, or it is suffering from memory corruption, before asking for further help, please try first to rebuild every single library your app uses as well as your app using the debug multi-threaded dynamic C runtime.</p>
<p>If you get linkage errors read section 5.7 of the FAQ document.</p>
<h2><a class="anchor" id="autotoc_md387"></a>
mingw-w64</h2>
<p>Make sure that mingw-w64's bin directory is in the search path, for example:</p>
<div class="fragment"><div class="line">set PATH=c:\mingw-w64\bin;%PATH%</div>
</div><!-- fragment --><p>then run <code>mingw32-make mingw32</code> in the root dir. There are other make targets available to build libcurl with more features, use:</p>
<ul>
<li><code>mingw32-make mingw32-zlib</code> to build with Zlib support;</li>
<li><code>mingw32-make mingw32-ssl-zlib</code> to build with SSL and Zlib enabled;</li>
<li><code>mingw32-make mingw32-ssh2-ssl-zlib</code> to build with SSH2, SSL, Zlib;</li>
<li><code>mingw32-make mingw32-ssh2-ssl-sspi-zlib</code> to build with SSH2, SSL, Zlib and SSPI support.</li>
</ul>
<p>If you have any problems linking libraries or finding header files, be sure to verify that the provided <code>Makefile.mk</code> files use the proper paths, and adjust as necessary. It is also possible to override these paths with environment variables, for example:</p>
<div class="fragment"><div class="line">set ZLIB_PATH=c:\zlib-1.2.12</div>
<div class="line">set OPENSSL_PATH=c:\openssl-3.0.5</div>
<div class="line">set LIBSSH2_PATH=c:\libssh2-1.10.0</div>
</div><!-- fragment --><p>It is also possible to build with other LDAP installations than MS LDAP; currently it is possible to build with native Win32 OpenLDAP, or with the <em>Novell CLDAP</em> SDK. If you want to use these you need to set these vars:</p>
<div class="fragment"><div class="line">set CPPFLAGS=-Ic:/openldap/include -DCURL_HAS_OPENLDAP_LDAPSDK</div>
<div class="line">set LDFLAGS=-Lc:/openldap/lib</div>
<div class="line">set LIBS=-lldap -llber</div>
</div><!-- fragment --><p>or for using the Novell SDK:</p>
<div class="fragment"><div class="line">set CPPFLAGS=-Ic:/openldapsdk/inc -DCURL_HAS_NOVELL_LDAPSDK</div>
<div class="line">set LDFLAGS=-Lc:/openldapsdk/lib/mscvc</div>
<div class="line">set LIBS=-lldapsdk -lldapssl -lldapx</div>
</div><!-- fragment --><p>If you want to enable LDAPS support then append <code>-ldaps</code> to the make target.</p>
<h2><a class="anchor" id="autotoc_md388"></a>
Cygwin</h2>
<p>Almost identical to the Unix installation. Run the configure script in the curl source tree root with <code>sh configure</code>. Make sure you have the <code>sh</code> executable in <code>/bin/</code> or you will see the configure fail toward the end.</p>
<p>Run <code>make</code></p>
<h2><a class="anchor" id="autotoc_md389"></a>
MS-DOS</h2>
<p>Requires DJGPP in the search path and pointing to the Watt-32 stack via <code>WATT_PATH=c:/djgpp/net/watt</code>.</p>
<p>Run <code>make -f Makefile.dist djgpp</code> in the root curl dir.</p>
<p>For build configuration options, please see the mingw-w64 section.</p>
<p>Notes:</p>
<ul>
<li>DJGPP 2.04 beta has a <code>sscanf()</code> bug so the URL parsing is not done properly. Use DJGPP 2.03 until they fix it.</li>
<li>Compile Watt-32 (and OpenSSL) with the same version of DJGPP. Otherwise things go wrong because things like FS-extensions and <code>errno</code> values have been changed between releases.</li>
</ul>
<h2><a class="anchor" id="autotoc_md390"></a>
AmigaOS</h2>
<p>Run <code>make -f Makefile.dist amiga</code> in the root curl dir.</p>
<p>For build configuration options, please see the mingw-w64 section.</p>
<h2><a class="anchor" id="autotoc_md391"></a>
Disabling Specific Protocols in Windows builds</h2>
<p>The configure utility, unfortunately, is not available for the Windows environment, therefore, you cannot use the various disable-protocol options of the configure utility on this platform.</p>
<p>You can use specific defines to disable specific protocols and features. See <a class="el" href="md_build_2__deps_2curl-src_2docs_2_c_u_r_l-_d_i_s_a_b_l_e.html">CURL-DISABLE</a> for the full list.</p>
<p>If you want to set any of these defines you have the following options:</p>
<ul>
<li>Modify <code>lib/config-win32.h</code></li>
<li>Modify <code>lib/curl_setup.h</code></li>
<li>Modify <code>winbuild/Makefile.vc</code></li>
<li>Modify the "Preprocessor Definitions" in the libcurl project</li>
</ul>
<p>Note: The pre-processor settings can be found using the Visual Studio IDE under "Project -&gt; Properties -&gt; Configuration Properties -&gt; C/C++ -&gt;
Preprocessor".</p>
<h2><a class="anchor" id="autotoc_md392"></a>
Using BSD-style lwIP instead of Winsock TCP/IP stack in Win32 builds</h2>
<p>In order to compile libcurl and curl using BSD-style lwIP TCP/IP stack it is necessary to make the definition of the preprocessor symbol <code>USE_LWIPSOCK</code> visible to libcurl and curl compilation processes. To set this definition you have the following alternatives:</p>
<ul>
<li>Modify <code>lib/config-win32.h</code> and <code>src/config-win32.h</code></li>
<li>Modify <code>winbuild/Makefile.vc</code></li>
<li>Modify the "Preprocessor Definitions" in the libcurl project</li>
</ul>
<p>Note: The pre-processor settings can be found using the Visual Studio IDE under "Project -&gt; Properties -&gt; Configuration Properties -&gt; C/C++ -&gt;
Preprocessor".</p>
<p>Once that libcurl has been built with BSD-style lwIP TCP/IP stack support, in order to use it with your program it is mandatory that your program includes lwIP header file <code>&lt;lwip/opt.h&gt;</code> (or another lwIP header that includes this) before including any libcurl header. Your program does not need the <code>USE_LWIPSOCK</code> preprocessor definition which is for libcurl internals only.</p>
<p>Compilation has been verified with lwIP 1.4.0.</p>
<p>This BSD-style lwIP TCP/IP stack support must be considered experimental given that it has been verified that lwIP 1.4.0 still needs some polish, and libcurl might yet need some additional adjustment.</p>
<h2><a class="anchor" id="autotoc_md393"></a>
Important static libcurl usage note</h2>
<p>When building an application that uses the static libcurl library on Windows, you must add <code>-DCURL_STATICLIB</code> to your <code>CFLAGS</code>. Otherwise the linker will look for dynamic import symbols.</p>
<h2><a class="anchor" id="autotoc_md394"></a>
Legacy Windows and SSL</h2>
<p>Schannel (from Windows SSPI), is the native SSL library in Windows. However, Schannel in Windows &lt;= XP is unable to connect to servers that no longer support the legacy handshakes and algorithms used by those versions. If you will be using curl in one of those earlier versions of Windows you should choose another SSL backend such as OpenSSL.</p>
<h1><a class="anchor" id="autotoc_md395"></a>
Apple Platforms (macOS, iOS, tvOS, watchOS, and their simulator counterparts)</h1>
<p>On modern Apple operating systems, curl can be built to use Apple's SSL/TLS implementation, Secure Transport, instead of OpenSSL. To build with Secure Transport for SSL/TLS, use the configure option <code>--with-secure-transport</code>.</p>
<p>When Secure Transport is in use, the curl options <code>--cacert</code> and <code>--capath</code> and their libcurl equivalents, will be ignored, because Secure Transport uses the certificates stored in the Keychain to evaluate whether or not to trust the server. This, of course, includes the root certificates that ship with the OS. The <code>--cert</code> and <code>--engine</code> options, and their libcurl equivalents, are currently unimplemented in curl with Secure Transport.</p>
<p>In general, a curl build for an Apple <code>ARCH/SDK/DEPLOYMENT_TARGET</code> combination can be taken by providing appropriate values for <code>ARCH</code>, <code>SDK</code>, <code>DEPLOYMENT_TARGET</code> below and running the commands:</p>
<div class="fragment"><div class="line"># Set these three according to your needs</div>
<div class="line">export ARCH=x86_64</div>
<div class="line">export SDK=macosx</div>
<div class="line">export DEPLOYMENT_TARGET=10.8</div>
<div class="line"> </div>
<div class="line">export CFLAGS=&quot;-arch $ARCH -isysroot $(xcrun -sdk $SDK --show-sdk-path) -m$SDK-version-min=$DEPLOYMENT_TARGET&quot;</div>
<div class="line">./configure --host=$ARCH-apple-darwin --prefix $(pwd)/artifacts --with-secure-transport</div>
<div class="line">make -j8</div>
<div class="line">make install</div>
</div><!-- fragment --><p>Above will build curl for macOS platform with <code>x86_64</code> architecture and <code>10.8</code> as deployment target.</p>
<p>Here is an example for iOS device:</p>
<div class="fragment"><div class="line">export ARCH=arm64</div>
<div class="line">export SDK=iphoneos</div>
<div class="line">export DEPLOYMENT_TARGET=11.0</div>
<div class="line"> </div>
<div class="line">export CFLAGS=&quot;-arch $ARCH -isysroot $(xcrun -sdk $SDK --show-sdk-path) -m$SDK-version-min=$DEPLOYMENT_TARGET&quot;</div>
<div class="line">./configure --host=$ARCH-apple-darwin --prefix $(pwd)/artifacts --with-secure-transport</div>
<div class="line">make -j8</div>
<div class="line">make install</div>
</div><!-- fragment --><p>Another example for watchOS simulator for macs with Apple Silicon:</p>
<div class="fragment"><div class="line">export ARCH=arm64</div>
<div class="line">export SDK=watchsimulator</div>
<div class="line">export DEPLOYMENT_TARGET=5.0</div>
<div class="line"> </div>
<div class="line">export CFLAGS=&quot;-arch $ARCH -isysroot $(xcrun -sdk $SDK --show-sdk-path) -m$SDK-version-min=$DEPLOYMENT_TARGET&quot;</div>
<div class="line">./configure --host=$ARCH-apple-darwin --prefix $(pwd)/artifacts --with-secure-transport</div>
<div class="line">make -j8</div>
<div class="line">make install</div>
</div><!-- fragment --><p>In all above, the built libraries and executables can be found in the <code>artifacts</code> folder.</p>
<h1><a class="anchor" id="autotoc_md396"></a>
Android</h1>
<p>When building curl for Android it's recommended to use a Linux/macOS environment since using curl's <code>configure</code> script is the easiest way to build curl for Android. Before you can build curl for Android, you need to install the Android NDK first. This can be done using the SDK Manager that is part of Android Studio. Once you have installed the Android NDK, you need to figure out where it has been installed and then set up some environment variables before launching <code>configure</code>. On macOS, those variables could look like this to compile for <code>aarch64</code> and API level 29:</p>
<div class="fragment"><div class="line">export ANDROID_NDK_HOME=~/Library/Android/sdk/ndk/25.1.8937393 # Point into your NDK.</div>
<div class="line">export HOST_TAG=darwin-x86_64 # Same tag for Apple Silicon. Other OS values here: https://developer.android.com/ndk/guides/other_build_systems#overview</div>
<div class="line">export TOOLCHAIN=$ANDROID_NDK_HOME/toolchains/llvm/prebuilt/$HOST_TAG</div>
<div class="line">export AR=$TOOLCHAIN/bin/llvm-ar</div>
<div class="line">export AS=$TOOLCHAIN/bin/llvm-as</div>
<div class="line">export CC=$TOOLCHAIN/bin/aarch64-linux-android21-clang</div>
<div class="line">export CXX=$TOOLCHAIN/bin/aarch64-linux-android21-clang++</div>
<div class="line">export LD=$TOOLCHAIN/bin/ld</div>
<div class="line">export RANLIB=$TOOLCHAIN/bin/llvm-ranlib</div>
<div class="line">export STRIP=$TOOLCHAIN/bin/llvm-strip</div>
</div><!-- fragment --><p>When building on Linux or targeting other API levels or architectures, you need to adjust those variables accordingly. After that you can build curl like this: </p><pre class="fragment">./configure --host aarch64-linux-android --with-pic --disable-shared
</pre><p> Note that this will not give you SSL/TLS support. If you need SSL/TLS, you have to build curl against a SSL/TLS layer, e.g. OpenSSL, because it's impossible for curl to access Android's native SSL/TLS layer. To build curl for Android using OpenSSL, follow the OpenSSL build instructions and then install <code>libssl.a</code> and <code>libcrypto.a</code> to <code>$TOOLCHAIN/sysroot/usr/lib</code> and copy <code>include/openssl</code> to <code>$TOOLCHAIN/sysroot/usr/include</code>. Now you can build curl for Android using OpenSSL like this:</p>
<div class="fragment"><div class="line">LIBS=&quot;-lssl -lcrypto -lc++&quot; # For OpenSSL/BoringSSL. In general, you will need to the SSL/TLS layer&#39;s transitive dependencies if you are linking statically.</div>
<div class="line">./configure --host aarch64-linux-android --with-pic --disable-shared --with-openssl=&quot;$TOOLCHAIN/sysroot/usr&quot;</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md397"></a>
IBM i</h1>
<p>For IBM i (formerly OS/400), you can use curl in two different ways:</p>
<ul>
<li>Natively, running in the <b>ILE</b>. The obvious use is being able to call curl from ILE C or RPG applications.<ul>
<li>You will need to build this from source. See <code>packages/OS400/README</code> for the ILE specific build instructions.</li>
</ul>
</li>
<li>In the <b>PASE</b> environment, which runs AIX programs. curl will be built as it would be on AIX.<ul>
<li>IBM provides builds of curl in their Yum repository for PASE software.</li>
<li>To build from source, follow the Unix instructions.</li>
</ul>
</li>
</ul>
<p>There are some additional limitations and quirks with curl on this platform; they affect both environments.</p>
<h2><a class="anchor" id="autotoc_md398"></a>
Multi-threading notes</h2>
<p>By default, jobs in IBM i will not start with threading enabled. (Exceptions include interactive PASE sessions started by <code>QP2TERM</code> or SSH.) If you use curl in an environment without threading when options like asynchronous DNS were enabled, you will get messages like:</p>
<div class="fragment"><div class="line">getaddrinfo() thread failed to start</div>
</div><!-- fragment --><p>Do not panic. curl and your program are not broken. You can fix this by:</p>
<ul>
<li>Set the environment variable <code>QIBM_MULTI_THREADED</code> to <code>Y</code> before starting your program. This can be done at whatever scope you feel is appropriate.</li>
<li>Alternatively, start the job with the <code>ALWMLTTHD</code> parameter set to <code>*YES</code>.</li>
</ul>
<h1><a class="anchor" id="autotoc_md399"></a>
Cross compile</h1>
<p>Download and unpack the curl package.</p>
<p><code>cd</code> to the new directory. (e.g. <code>cd curl-7.12.3</code>)</p>
<p>Set environment variables to point to the cross-compile toolchain and call configure with any options you need. Be sure and specify the <code>--host</code> and <code>--build</code> parameters at configuration time. The following script is an example of cross-compiling for the IBM 405GP PowerPC processor using the toolchain on Linux.</p>
<div class="fragment"><div class="line">#! /bin/sh</div>
<div class="line"> </div>
<div class="line">export PATH=$PATH:/opt/hardhat/devkit/ppc/405/bin</div>
<div class="line">export CPPFLAGS=&quot;-I/opt/hardhat/devkit/ppc/405/target/usr/include&quot;</div>
<div class="line">export AR=ppc_405-ar</div>
<div class="line">export AS=ppc_405-as</div>
<div class="line">export LD=ppc_405-ld</div>
<div class="line">export RANLIB=ppc_405-ranlib</div>
<div class="line">export CC=ppc_405-gcc</div>
<div class="line">export NM=ppc_405-nm</div>
<div class="line"> </div>
<div class="line">./configure --target=powerpc-hardhat-linux</div>
<div class="line">    --host=powerpc-hardhat-linux</div>
<div class="line">    --build=i586-pc-linux-gnu</div>
<div class="line">    --prefix=/opt/hardhat/devkit/ppc/405/target/usr/local</div>
<div class="line">    --exec-prefix=/usr/local</div>
</div><!-- fragment --><p>You may also need to provide a parameter like <code>--with-random=/dev/urandom</code> to configure as it cannot detect the presence of a random number generating device for a target system. The <code>--prefix</code> parameter specifies where curl will be installed. If <code>configure</code> completes successfully, do <code>make</code> and <code>make install</code> as usual.</p>
<p>In some cases, you may be able to simplify the above commands to as little as: </p><pre class="fragment">./configure --host=ARCH-OS
</pre> <h1><a class="anchor" id="autotoc_md400"></a>
REDUCING SIZE</h1>
<p>There are a number of configure options that can be used to reduce the size of libcurl for embedded applications where binary size is an important factor. First, be sure to set the <code>CFLAGS</code> variable when configuring with any relevant compiler optimization flags to reduce the size of the binary. For gcc, this would mean at minimum the -Os option, and potentially the <code>-march=X</code>, <code>-mdynamic-no-pic</code> and <code>-flto</code> options as well, e.g. </p><pre class="fragment">./configure CFLAGS='-Os' LDFLAGS='-Wl,-Bsymbolic'...
</pre><p> Note that newer compilers often produce smaller code than older versions due to improved optimization.</p>
<p>Be sure to specify as many <code>--disable-</code> and <code>--without-</code> flags on the configure command-line as you can to disable all the libcurl features that you know your application is not going to need. Besides specifying the <code>--disable-PROTOCOL</code> flags for all the types of URLs your application will not use, here are some other flags that can reduce the size of the library by disabling support for some feature:</p>
<ul>
<li><code>--disable-alt-svc</code> (<a class="el" href="struct_h_t_t_p.html">HTTP</a> Alt-Svc)</li>
<li><code>--disable-ares</code> (the C-ARES DNS library)</li>
<li><code>--disable-cookies</code> (<a class="el" href="struct_h_t_t_p.html">HTTP</a> cookies)</li>
<li><code>--disable-crypto-auth</code> (cryptographic authentication)</li>
<li><code>--disable-dateparse</code> (date parsing for time conditionals)</li>
<li><code>--disable-dnsshuffle</code> (internal server load spreading)</li>
<li><code>--disable-doh</code> (DNS-over-HTTP)</li>
<li><code>--disable-get-easy-options</code> (lookup easy options at runtime)</li>
<li><code>--disable-hsts</code> (<a class="el" href="struct_h_t_t_p.html">HTTP</a> Strict Transport Security)</li>
<li><code>--disable-http-auth</code> (all <a class="el" href="struct_h_t_t_p.html">HTTP</a> authentication)</li>
<li><code>--disable-ipv6</code> (IPv6)</li>
<li><code>--disable-libcurl-option</code> (&ndash;libcurl C code generation support)</li>
<li><code>--disable-manual</code> (built-in documentation)</li>
<li><code>--disable-netrc</code> (.netrc file)</li>
<li><code>--disable-ntlm-wb</code> (NTLM WinBind)</li>
<li><code>--disable-progress-meter</code> (graphical progress meter in library)</li>
<li><code>--disable-proxy</code> (<a class="el" href="struct_h_t_t_p.html">HTTP</a> and SOCKS proxies)</li>
<li><code>--disable-pthreads</code> (multi-threading)</li>
<li><code>--disable-socketpair</code> (socketpair for asynchronous name resolving)</li>
<li><code>--disable-threaded-resolver</code> (threaded name resolver)</li>
<li><code>--disable-tls-srp</code> (Secure Remote Password authentication for TLS)</li>
<li><code>--disable-unix-sockets</code> (UNIX sockets)</li>
<li><code>--disable-verbose</code> (eliminates debugging strings and error code strings)</li>
<li><code>--disable-versioned-symbols</code> (versioned symbols)</li>
<li><code>--enable-symbol-hiding</code> (eliminates unneeded symbols in the shared library)</li>
<li><code>--without-brotli</code> (Brotli on-the-fly decompression)</li>
<li><code>--without-libpsl</code> (Public Suffix List in cookies)</li>
<li><code>--without-nghttp2</code> (HTTP/2 using nghttp2)</li>
<li><code>--without-ngtcp2</code> (HTTP/2 using ngtcp2)</li>
<li><code>--without-zstd</code> (Zstd on-the-fly decompression)</li>
<li><code>--without-libidn2</code> (internationalized domain names)</li>
<li><code>--without-librtmp</code> (RTMP)</li>
<li><code>--without-ssl</code> (SSL/TLS)</li>
<li><code>--without-zlib</code> (on-the-fly decompression)</li>
</ul>
<p>The GNU compiler and linker have a number of options that can reduce the size of the libcurl dynamic libraries on some platforms even further. Specify them by providing appropriate <code>CFLAGS</code> and <code>LDFLAGS</code> variables on the configure command-line, e.g. </p><pre class="fragment">CFLAGS="-Os -ffunction-sections -fdata-sections
        -fno-unwind-tables -fno-asynchronous-unwind-tables -flto"
LDFLAGS="-Wl,-s -Wl,-Bsymbolic -Wl,--gc-sections"
</pre><p> Be sure also to strip debugging symbols from your binaries after compiling using 'strip' (or the appropriate variant if cross-compiling). If space is really tight, you may be able to remove some unneeded sections of the shared library using the -R option to objcopy (e.g. the .comment section).</p>
<p>Using these techniques it is possible to create a basic HTTP-only libcurl shared library for i386 Linux platforms that is only 133 KiB in size (as of libcurl version 7.80.0, using gcc 11.2.0).</p>
<p>You may find that statically linking libcurl to your application will result in a lower total size than dynamically linking.</p>
<p>Note that the curl test harness can detect the use of some, but not all, of the <code>--disable</code> statements suggested above. Use will cause tests relying on those features to fail. The test harness can be manually forced to skip the relevant tests by specifying certain key words on the <code>runtests.pl</code> command line. Following is a list of appropriate key words for those configure options that are not automatically detected:</p>
<ul>
<li><code>--disable-cookies</code> !cookies</li>
<li><code>--disable-dateparse</code> !RETRY-AFTER !<code>CURLOPT_TIMECONDITION</code> !<code>CURLINFO_FILETIME</code> !<code>If-Modified-Since</code> !<code>curl_getdate</code> !<code>-z</code></li>
<li><code>--disable-libcurl-option</code> !<code>--libcurl</code></li>
<li><code>--disable-verbose</code> !verbose\ logs</li>
</ul>
<h1><a class="anchor" id="autotoc_md401"></a>
PORTS</h1>
<p>This is a probably incomplete list of known CPU architectures and operating systems that curl has been compiled for. If you know a system curl compiles and runs on, that is not listed, please let us know!</p>
<h2><a class="anchor" id="autotoc_md402"></a>
92 Operating Systems</h2>
<pre class="fragment">AIX, AmigaOS, Android, Aros, BeOS, Blackberry 10, Blackberry Tablet OS,
Cell OS, Chrome OS, Cisco IOS, Cygwin, DG/UX, Dragonfly BSD, DR DOS, eCOS,
FreeBSD, FreeDOS, FreeRTOS, Fuchsia, Garmin OS, Genode, Haiku, HardenedBSD,
HP-UX, Hurd, Illumos, Integrity, iOS, ipadOS, IRIX, Linux, Lua RTOS,
Mac OS 9, macOS, Mbed, Micrium, MINIX, MorphOS, MPE/iX, MS-DOS, NCR MP-RAS,
NetBSD, Netware, Nintendo Switch, NonStop OS, NuttX, Omni OS, OpenBSD,
OpenStep, Orbis OS, OS/2, OS/400, OS21, Plan 9, PlayStation Portable, QNX,
Qubes OS, ReactOS, Redox, RICS OS, RTEMS, Sailfish OS, SCO Unix, Serenity,
SINIX-Z, Solaris, SunOS, Syllable OS, Symbian, Tizen, TPF, Tru64, tvOS,
ucLinux, Ultrix, UNICOS, UnixWare, VMS, vxWorks, watchOS, WebOS,
Wii system software, Windows, Windows CE, Xbox System, Xenix, Zephyr,
z/OS, z/TPF, z/VM, z/VSE
</pre> <h2><a class="anchor" id="autotoc_md403"></a>
26 CPU Architectures</h2>
<pre class="fragment">Alpha, ARC, ARM, AVR32, CompactRISC, Elbrus, ETRAX, HP-PA, Itanium,
LoongArch, m68k, m88k, MicroBlaze, MIPS, Nios, OpenRISC, POWER, PowerPC,
RISC-V, s390, SH4, SPARC, Tilera, VAX, x86, Xtensa
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
