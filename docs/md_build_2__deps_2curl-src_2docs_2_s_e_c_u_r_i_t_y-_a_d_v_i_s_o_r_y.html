<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: Anatomy of a curl security advisory</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Anatomy of a curl security advisory</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="autotoc_md451"></a> As described in the <a href="https://curl.se/dev/secprocess.html">Security Process</a> document, when a security vulnerability has been reported to the project and confirmed, we author an advisory document for the issue. It should ideally be written in cooperation with the reporter to make sure all the angles and details of the problem are gathered and described correctly and succinctly.</p>
<h1><a class="anchor" id="autotoc_md452"></a>
New document</h1>
<p>A security advisory for curl is created in the <code>docs/</code> folder in the <a href="https://github.com/curl/curl-www">curl-www</a> repository. It should be named <code>$CVEID.md</code> where <code>$CVEID</code> is the full CVE Id that has been registered for the flaw. Like <code>CVE-2016-0755</code>. The <code>.md</code> extension of course means that the document is written using markdown.</p>
<p>The standard way to go about this is to first write the <code>VULNERABILITY</code> section for the document, so that there is description of the flaw available, then paste this description into the CVE Id request.</p>
<h2><a class="anchor" id="autotoc_md453"></a>
<code>vuln.pm</code></h2>
<p>The new issue should be entered at the top of the list in the file <code>vuln.pm</code> in the same directory. It holds a large array with all published curl vulnerabilities. All fields should be filled in accordingly, separated by a pipe character (<code>|</code>).</p>
<p>The eleven fields for each CVE in <code>vuln.pm</code> are, in order:</p>
<p>HTML page name, first vulnerable version, last vulnerable version, name of the issue, CVE Id, announce date (<code>YYYYMMDD</code>), report to the project date (<code>YYYYMMDD</code>), CWE, awarded reward amount (USD), area (single word), C-issue (<code>-</code> if not a C issue at all, <code>OVERFLOW</code> , <code>OVERREAD</code>, <code>DOUBLE_FREE</code>, <code>USE_AFTER_FREE</code>, <code>NULL_MISTAKE</code>, <code>UNINIT</code>)</p>
<h2><a class="anchor" id="autotoc_md454"></a>
<code>Makefile</code></h2>
<p>The new CVE web page file name needs to be added in the <code>Makefile</code>'s <code>CVELIST</code> macro.</p>
<p>When the markdown is in place and the <code>Makefile</code> and <code>vuln.pm</code> are updated, all other files and metadata for all curl advisories and versions get generated automatically using those files.</p>
<h1><a class="anchor" id="autotoc_md455"></a>
Document format</h1>
<p>The easy way is to start with a recent previously published advisory and just blank out old texts and save it using a new name. Save the subtitles and general layout.</p>
<p>Some details and metadata will be extracted from this document so it is important to stick to the existing format.</p>
<p>The first list must be the title of the issue.</p>
<h2><a class="anchor" id="autotoc_md456"></a>
VULNERABILITY</h2>
<p>The first subtitle should be <code>VULNERABILITY</code>. That should then include a through and detailed description of the flaw. Including how it can be triggered and maybe something about what might happen if triggered or exploited.</p>
<h2><a class="anchor" id="autotoc_md457"></a>
INFO</h2>
<p>The next section is <code>INFO</code> which adds meta data information about the flaw. It specifically mentions the official CVE Id for the issue and it must list the CWE Id, starting on its own line. We write CWE identifiers in advisories with the full (official) explanation on the right side of a colon. Like this:</p>
<p><code>CWE-305: Authentication Bypass by Primary Weakness</code></p>
<h2><a class="anchor" id="autotoc_md458"></a>
AFFECTED VERSIONS</h2>
<p>The third section first lists what versions that are affected, then adds clarity by stressing what versions that are <em>not</em> affected. A third line adds information about which specific git commit that introduced the vulnerability.</p>
<p>The <code>Introduced-in</code> commit should be a full URL that displays the commit, but should work as a stand-alone commit hash if everything up to the last slash is cut out.</p>
<p>An example using the correct syntax:</p>
<div class="fragment"><div class="line">- Affected versions: curl 7.16.1 to and including 7.88.1</div>
<div class="line">- Not affected versions: curl &lt; 7.16.1 and curl &gt;= 8.0.0</div>
<div class="line">- Introduced-in: https://github.com/curl/curl/commit/2147284cad</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md459"></a>
THE SOLUTION</h2>
<p>This section describes and discusses the fix. The only mandatory information here is the link to the git commit that fixes the problem.</p>
<p>The <code>Fixed-in</code> value should be a full URL that displays the commit, but should work as a stand-alone commit hash if everything up to the last slash is cut out.</p>
<p>Example:</p>
<p><code>- Fixed-in: <a href="https://github.com/curl/curl/commit/af369db4d3833272b8ed">https://github.com/curl/curl/commit/af369db4d3833272b8ed</a></code></p>
<h2><a class="anchor" id="autotoc_md460"></a>
RECOMMENDATIONS</h2>
<p>This section lists the recommended actions for the users in a top to bottom priority order and should ideally contain three items but no less than two.</p>
<p>The top two are almost always <code>upgrade curl to version XXX</code> and <code>apply the patch to your local version</code>.</p>
<h2><a class="anchor" id="autotoc_md461"></a>
TIMELINE</h2>
<p>Detail when this report was received in the project. When package distributors were notified (via the distros mailing list or similar)</p>
<p>When the advisory and fixed version are released.</p>
<h2><a class="anchor" id="autotoc_md462"></a>
CREDITS</h2>
<p>Mention the reporter and patch author at least, then everyone else involved you think deserves a mention.</p>
<p>If you want to mention more than one name, separate the names with comma (<code>,</code>).</p>
<div class="fragment"><div class="line">- Reported-by: Full Name</div>
<div class="line">- Patched-by: Full Name</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
