<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.10.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CrossGuard: ABI Compatibility test</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">CrossGuard
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">ABI Compatibility test</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>abicheck.sh uses libabigail to check ABI stability. It will abort if the current source tree has a change that breaks binary compatibility.</p>
<p>This protects against the common scenario where:</p><ul>
<li>an app is compiled against the current zlib-ng</li>
<li>the system package manager updates the zlib-ng shared library</li>
<li>the app now crashes because some symbol is missing or some public structure or parameter has changed type or size</li>
</ul>
<p>If run with &ndash;zlib-compat, it verifies that the current source tree generates a library that is ABI-compatible with the reference release of classic zlib. This ensures that building zlib-ng with &ndash;zlib-compat does what it says on the tin.</p>
<p>abicheck.sh is not perfect, but it can catch many common compatibility issues.</p>
<h1><a class="anchor" id="autotoc_md738"></a>
Cached files test/abi/*.abi</h1>
<p>Comparing to the old version of zlib (or zlib-ng) means someone has to check out and build the previous source tree and extract its .abi using abidw. This can be slow.</p>
<p>If you don't mind the slowness, run abicheck.sh &ndash;refresh-if, and it will download and build the reference version and extract the .abi on the spot if needed. (FIXME: should this be the default?)</p>
<p>On the next run, the reference .abi file will already be present, and that step will be skipped. It's stored in the tests/abi directory, in a file with the architecture and git hash in the name.</p>
<p>If you're running continuous integration which clear out the source tree on each run, and you don't want your build machines constantly downloading and building the old version, you can check the .abi file into git.</p>
<p>To make this easier, a helper script could be written to automatically build all the configurations tested by .github/workflows/abicheck.yml Then they could be checked into git en masse by a maintainer when a new platform is added or a new major version (which intentionally breaks backwards compatibility) is being prepared.</p>
<h1><a class="anchor" id="autotoc_md739"></a>
Further reading</h1>
<ul>
<li><a href="https://sourceware.org/libabigail/manual/">https://sourceware.org/libabigail/manual/</a></li>
<li><a href="https://developers.redhat.com/blog/2014/10/23/comparing-abis-for-compatibility-with-libabigail-part-1/">https://developers.redhat.com/blog/2014/10/23/comparing-abis-for-compatibility-with-libabigail-part-1/</a></li>
<li><a href="https://developers.redhat.com/blog/2020/04/02/how-to-write-an-abi-compliance-checker-using-libabigail/">https://developers.redhat.com/blog/2020/04/02/how-to-write-an-abi-compliance-checker-using-libabigail/</a> </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.10.0
</small></address>
</body>
</html>
